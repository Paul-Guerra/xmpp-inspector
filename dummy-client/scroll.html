<html>
<head>
  
<link rel="stylesheet" href="/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="/codemirror/lib/codemirror.css">
<script src="/codemirror/lib/codemirror.js"></script>
<script src="/codemirror/mode/xml/xml.js"></script>

<style type="text/css">
  .code {
    width: 300px;
    height: 500px;
  }

</style>
</head>
<body >
        <div id="code" name="code">
          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;

          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;
          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;
          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;
          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;
          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;
          &lt;html style="color: green"&gt;
            &lt;!-- this is a comment --&gt;
            &lt;head&gt;
              &lt;title&gt;HTML Example&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
              The indentation tries to be &lt;em&gt;somewhat &amp;quot;do what
              I mean&amp;quot;&lt;/em&gt;... but might not match your style.
            &lt;/body&gt;
          &lt;/html&gt;
        </div>
      
  <script type="text/javascript" src="jquery-1.11.0.min.js"></script>
  <script type="text/javascript">
    function append(){
        console.log(editor.getScrollInfo());

        var content = $("#code").val();
        // var lastViewportLine = editor.getViewport().to; 
        var lastLineNumber = editor.lastLine();
        var lastLineHandler = editor.getLineHandle(lastLineNumber);
        var lastLineCharCount = lastLineHandler.text.length;
        var cursorOptions = {scroll: false};
        
        // insert content
        editor.replaceRange(content, {line: Infinity, ch: lastLineCharCount});
      }
  </script>
  
</body>
</html>